<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CodeAnalyst System Documentation</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f5f5;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            border-radius: 8px;
        }
        
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
            margin-bottom: 30px;
            font-size: 2.5em;
        }
        
        h2 {
            color: #34495e;
            margin-top: 40px;
            margin-bottom: 20px;
            padding-bottom: 8px;
            border-bottom: 2px solid #ecf0f1;
            font-size: 2em;
        }
        
        h3 {
            color: #555;
            margin-top: 30px;
            margin-bottom: 15px;
            font-size: 1.5em;
        }
        
        h4 {
            color: #666;
            margin-top: 20px;
            margin-bottom: 10px;
            font-size: 1.2em;
        }
        
        .diagram-container {
            background: #fafafa;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 20px;
            margin: 30px 0;
            overflow-x: auto;
        }
        
        .diagram-container mermaid {
            display: flex;
            justify-content: center;
        }
        
        .diagram-title {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.1em;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
        }
        
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        th {
            background-color: #3498db;
            color: white;
            font-weight: bold;
        }
        
        tr:hover {
            background-color: #f5f5f5;
        }
        
        ul, ol {
            margin-left: 30px;
            margin-bottom: 15px;
        }
        
        li {
            margin-bottom: 8px;
        }
        
        .feature-box {
            background: #e8f4f8;
            border-left: 4px solid #3498db;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }
        
        .security-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }
        
        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            color: #c7254e;
        }
        
        pre {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 15px 0;
        }
        
        .toc {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 20px;
            margin-bottom: 30px;
        }
        
        .toc h3 {
            margin-top: 0;
            color: #2c3e50;
        }
        
        .toc ul {
            list-style-type: none;
            margin-left: 0;
        }
        
        .toc li {
            margin: 8px 0;
        }
        
        .toc a {
            color: #3498db;
            text-decoration: none;
        }
        
        .toc a:hover {
            text-decoration: underline;
        }
        
        .badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 3px;
            font-size: 0.85em;
            font-weight: bold;
            margin-left: 8px;
        }
        
        .badge-primary {
            background: #3498db;
            color: white;
        }
        
        .badge-success {
            background: #27ae60;
            color: white;
        }
        
        .badge-warning {
            background: #f39c12;
            color: white;
        }
        
        @media print {
            body {
                background: white;
            }
            
            .container {
                box-shadow: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>CodeAnalyst System Documentation</h1>
        <p style="font-size: 1.1em; color: #666; margin-bottom: 30px;">
            Comprehensive system architecture, database schema, and UML documentation
        </p>
        
        <div class="toc">
            <h3>Table of Contents</h3>
            <ul>
                <li><a href="#database-schema">1. Database Schema Diagram</a></li>
                <li><a href="#system-overview">2. System Overview Class Diagram</a></li>
                <li><a href="#auth-flow">3. Authentication Flow</a></li>
                <li><a href="#analysis-workflow">4. Analysis Workflow</a></li>
                <li><a href="#module-architecture">5. Module Architecture</a></li>
                <li><a href="#role-permissions">6. User Role & Permission System</a></li>
                <li><a href="#api-endpoints">7. API Endpoint Structure</a></li>
                <li><a href="#key-features">8. Key System Features</a></li>
                <li><a href="#security">9. Security Features</a></li>
                <li><a href="#deployment">10. Deployment Architecture</a></li>
            </ul>
        </div>
        
        <h2 id="database-schema">1. Database Schema Diagram</h2>
        <div class="diagram-container">
            <div class="diagram-title">Entity Relationship Diagram</div>
            <div class="mermaid">
erDiagram
    users ||--o{ user_api_keys : "has"
    users ||--o{ projects : "owns"
    users ||--o{ wordpress_connections : "has"
    users ||--o{ api_usage_logs : "tracks"
    users ||--o{ user_roles : "has"
    users ||--o{ project_users : "invited_to"
    users ||--o{ user_activation_log : "logged"
    
    projects ||--o{ url_analyses : "contains"
    projects ||--o{ code_analyses : "contains"
    projects ||--o{ analysis_history : "tracks"
    projects ||--o{ project_users : "has_members"
    projects ||--o{ module_permissions : "has_permissions"
    
    users {
        UUID id PK
        VARCHAR email UK
        VARCHAR name
        BIGINT github_id UK
        VARCHAR github_username
        TEXT github_access_token
        TEXT avatar_url
        VARCHAR plan
        INTEGER api_usage_count
        TIMESTAMP last_login
        BOOLEAN is_active
        BOOLEAN pending_approval
        TIMESTAMP approved_at
        UUID approved_by FK
        TIMESTAMP created_at
        TIMESTAMP updated_at
    }
    
    user_api_keys {
        UUID id PK
        UUID user_id FK
        VARCHAR provider
        TEXT encrypted_key
        VARCHAR key_name
        BOOLEAN is_active
        TIMESTAMP last_used
        TIMESTAMP created_at
        TIMESTAMP updated_at
    }
    
    projects {
        UUID id PK
        UUID user_id FK
        UUID admin_id FK
        VARCHAR name
        TEXT description
        VARCHAR type
        TEXT source_url
        VARCHAR github_repo
        VARCHAR status
        JSONB settings
        BOOLEAN is_active
        TIMESTAMP created_at
        TIMESTAMP updated_at
    }
    
    user_roles {
        UUID id PK
        UUID user_id FK
        VARCHAR role
        TIMESTAMP created_at
        UUID created_by FK
    }
    
    project_users {
        UUID id PK
        UUID project_id FK
        UUID user_id FK
        UUID invited_by FK
        TIMESTAMP invited_at
        BOOLEAN is_active
    }
    
    module_permissions {
        UUID id PK
        UUID project_id FK
        UUID user_id FK
        VARCHAR module_name
        BOOLEAN has_access
        TIMESTAMP created_at
        TIMESTAMP updated_at
    }
    
    url_analyses {
        UUID id PK
        UUID project_id FK
        TEXT url
        TEXT title
        VARCHAR status
        TEXT html_content
        JSONB meta_tags
        TEXT[] technologies
        JSONB scripts
        JSONB stylesheets
        JSONB links
        JSONB images
        JSONB performance_metrics
        JSONB seo_analysis
        JSONB accessibility_analysis
        JSONB security_analysis
        JSONB ai_insights
        JSONB business_recommendations
        JSONB technical_recommendations
        JSONB risk_assessment
        INTEGER analysis_duration_ms
        VARCHAR ai_provider
        VARCHAR ai_model
        DECIMAL confidence_score
        TIMESTAMP created_at
        TIMESTAMP updated_at
    }
    
    code_analyses {
        UUID id PK
        UUID project_id FK
        VARCHAR source_type
        TEXT source_reference
        VARCHAR status
        INTEGER total_files
        INTEGER total_lines
        TEXT[] languages
        TEXT[] frameworks
        INTEGER code_quality_score
        DECIMAL technical_debt_percentage
        DECIMAL test_coverage_percentage
        DECIMAL complexity_score
        JSONB system_overview
        JSONB technical_structure
        JSONB maintenance_needs
        JSONB ai_explanations
        JSONB business_recommendations
        JSONB risk_assessment
        JSONB test_results
        JSONB build_results
        JSONB static_analysis_results
        TIMESTAMP created_at
        TIMESTAMP updated_at
    }
    
    ai_response_cache {
        UUID id PK
        VARCHAR input_hash UK
        VARCHAR provider
        VARCHAR model
        TEXT prompt_text
        TEXT response_text
        DECIMAL confidence_score
        INTEGER token_count
        INTEGER response_time_ms
        TIMESTAMP created_at
        TIMESTAMP expires_at
    }
    
    api_usage_logs {
        UUID id PK
        UUID user_id FK
        UUID analysis_id
        VARCHAR analysis_type
        VARCHAR provider
        VARCHAR model
        INTEGER tokens_used
        DECIMAL cost_usd
        INTEGER duration_ms
        BOOLEAN success
        TEXT error_message
        TIMESTAMP created_at
    }
    
    analysis_history {
        UUID id PK
        UUID project_id FK
        VARCHAR analysis_type
        UUID analysis_id
        INTEGER previous_score
        INTEGER current_score
        INTEGER score_change
        JSONB changes_detected
        TEXT[] improvement_areas
        TEXT[] regression_areas
        TIMESTAMP created_at
    }
    
    wordpress_connections {
        UUID id PK
        UUID user_id FK
        UUID project_id FK
        VARCHAR api_key UK
        TEXT site_url
        VARCHAR site_name
        VARCHAR wordpress_version
        VARCHAR active_theme
        JSONB active_plugins
        JSONB site_health
        VARCHAR php_version
        BOOLEAN is_connected
        TIMESTAMP last_sync
        TIMESTAMP created_at
        TIMESTAMP updated_at
    }
    
    user_activation_log {
        UUID id PK
        UUID user_id FK
        VARCHAR action
        UUID performed_by FK
        TEXT reason
        TIMESTAMP created_at
    }
            </div>
        </div>
        
        <h2 id="system-overview">2. System Overview Class Diagram</h2>
        <div class="diagram-container">
            <div class="diagram-title">Core System Classes and Relationships</div>
            <div class="mermaid">
classDiagram
    class User {
        +UUID id
        +String email
        +String name
        +String plan
        +Boolean isActive
        +login()
        +logout()
        +updateProfile()
    }
    
    class Project {
        +UUID id
        +String name
        +String type
        +String status
        +createAnalysis()
        +getAnalyses()
        +updateSettings()
    }
    
    class Analysis {
        +UUID id
        +String status
        +DateTime createdAt
        +analyze()
        +getResults()
    }
    
    class URLAnalysis {
        +String url
        +Object performanceMetrics
        +Object seoAnalysis
        +Object securityAnalysis
        +scanWebsite()
        +generateReport()
    }
    
    class CodeAnalysis {
        +String sourceType
        +Integer totalFiles
        +Array languages
        +Integer qualityScore
        +analyzeCode()
        +calculateMetrics()
    }
    
    class AIService {
        +String provider
        +String model
        +generateInsights()
        +analyzeContent()
        +cacheResponse()
    }
    
    class WordPressConnection {
        +String siteUrl
        +String apiKey
        +Boolean isConnected
        +syncData()
        +getHealth()
    }
    
    class UserRole {
        +String role
        +checkPermission()
        +hasAccess()
    }
    
    class ModulePermission {
        +String moduleName
        +Boolean hasAccess
        +grantAccess()
        +revokeAccess()
    }
    
    User "1" --> "*" Project : owns
    User "1" --> "*" UserRole : has
    User "1" --> "*" WordPressConnection : manages
    Project "1" --> "*" Analysis : contains
    Analysis <|-- URLAnalysis
    Analysis <|-- CodeAnalysis
    Analysis --> AIService : uses
    Project "1" --> "*" ModulePermission : has
    User "*" --> "*" Project : member_of
            </div>
        </div>
        
        <h2 id="auth-flow">3. Authentication Flow Sequence Diagram</h2>
        <div class="diagram-container">
            <div class="diagram-title">User Authentication Process</div>
            <div class="mermaid">
sequenceDiagram
    participant User
    participant Frontend
    participant Backend
    participant Database
    participant GitHub
    participant Supabase
    
    alt GitHub OAuth
        User->>Frontend: Click "Login with GitHub"
        Frontend->>GitHub: Redirect to OAuth
        GitHub->>User: Request authorization
        User->>GitHub: Approve
        GitHub->>Backend: Callback with code
        Backend->>GitHub: Exchange code for token
        GitHub->>Backend: Return access token
        Backend->>Database: Create/Update user
        Backend->>Frontend: Return JWT token
    else Email/Password
        User->>Frontend: Enter credentials
        Frontend->>Backend: POST /auth/login-supabase
        Backend->>Database: Verify credentials
        Database->>Backend: User data
        Backend->>Backend: Generate JWT
        Backend->>Frontend: Return JWT token
    else Google OAuth (Supabase)
        User->>Frontend: Click "Login with Google"
        Frontend->>Supabase: OAuth request
        Supabase->>User: Google auth
        User->>Supabase: Approve
        Supabase->>Backend: User data
        Backend->>Database: Sync user
        Backend->>Frontend: Return JWT token
    end
    
    Frontend->>Frontend: Store token in localStorage
    Frontend->>User: Redirect to Dashboard
            </div>
        </div>
        
        <h2 id="analysis-workflow">4. Analysis Workflow Activity Diagram</h2>
        <div class="diagram-container">
            <div class="diagram-title">Analysis Process Flow</div>
            <div class="mermaid">
stateDiagram-v2
    [*] --> SelectModule: User logs in
    SelectModule --> WebsiteAnalyst: Choose Website Analysis
    SelectModule --> CodeAnalyst: Choose Code Analysis
    SelectModule --> ContentAnalyst: Choose Content Analysis
    SelectModule --> ContentCreator: Choose Content Creation
    SelectModule --> AutoProgrammer: Choose Auto Programming
    
    WebsiteAnalyst --> EnterURL: Input website URL
    EnterURL --> ScanWebsite: Start scan
    ScanWebsite --> CollectData: Fetch HTML, scripts, styles
    CollectData --> AnalyzeMetrics: Performance, SEO, Security
    AnalyzeMetrics --> AIAnalysis: Generate AI insights
    AIAnalysis --> SaveResults: Store in database
    SaveResults --> DisplayReport: Show to user
    
    CodeAnalyst --> UploadCode: Upload ZIP/GitHub
    UploadCode --> ParseCode: Extract files
    ParseCode --> DetectLanguages: Identify tech stack
    DetectLanguages --> CalculateMetrics: Quality, complexity, debt
    CalculateMetrics --> AICodeAnalysis: AI recommendations
    AICodeAnalysis --> SaveCodeResults: Store analysis
    SaveCodeResults --> DisplayCodeReport: Show report
    
    DisplayReport --> [*]
    DisplayCodeReport --> [*]
            </div>
        </div>
        
        <h2 id="module-architecture">5. Module Architecture Component Diagram</h2>
        <div class="diagram-container">
            <div class="diagram-title">System Architecture Overview</div>
            <div class="mermaid">
graph TB
    subgraph Frontend["Frontend (React + TypeScript + Vite)"]
        UI[User Interface]
        Auth[Auth Store]
        Project[Project Context]
        Services[Frontend Services]
        
        subgraph Modules["Analysis Modules"]
            WA[Website Analyst]
            CA[Code Analyst]
            CNA[Content Analyst]
            CC[Content Creator]
            AP[Auto Programmer]
        end
    end
    
    subgraph Backend["Backend (Node.js + Express)"]
        API[API Routes]
        Middleware[Auth Middleware]
        
        subgraph BackendServices["Services"]
            DB[Database Service]
            AI[AI Analysis Service]
            WP[WordPress Service]
            GitHub[GitHub Service]
            Queue[Queue Service]
        end
    end
    
    subgraph Database["Database (PostgreSQL/Supabase)"]
        Users[(Users)]
        Projects[(Projects)]
        Analyses[(Analyses)]
        Cache[(AI Cache)]
        Logs[(Usage Logs)]
    end
    
    subgraph External["External Services"]
        OpenAI[OpenAI API]
        GoogleAI[Google AI API]
        GitHubAPI[GitHub API]
        SupabaseAuth[Supabase Auth]
    end
    
    UI --> Auth
    UI --> Project
    UI --> Services
    Modules --> Services
    Services --> API
    API --> Middleware
    Middleware --> BackendServices
    BackendServices --> Database
    BackendServices --> External
            </div>
        </div>
        
        <h2 id="role-permissions">6. User Role & Permission System</h2>
        <div class="diagram-container">
            <div class="diagram-title">Role-Based Access Control Structure</div>
            <div class="mermaid">
graph TD
    subgraph Roles["User Roles"]
        SA[Superadmin]
        Admin[Admin]
        User[Regular User]
    end
    
    subgraph Permissions["Permissions"]
        SA --> ManageUsers[Manage All Users]
        SA --> ManageProjects[Manage All Projects]
        SA --> ViewAnalytics[View System Analytics]
        SA --> ConfigureSystem[System Configuration]
        
        Admin --> CreateProject[Create Projects]
        Admin --> InviteUsers[Invite Users to Projects]
        Admin --> ManageModules[Manage Module Access]
        Admin --> ViewProjectData[View Project Data]
        
        User --> ViewOwnProjects[View Own Projects]
        User --> RunAnalyses[Run Analyses]
        User --> ViewResults[View Results]
    end
    
    subgraph Modules["Module Access Control"]
        WA2[Website Analyst]
        CA2[Code Analyst]
        CNA2[Content Analyst]
        CC2[Content Creator]
        AP2[Auto Programmer]
    end
    
    ManageModules --> WA2
    ManageModules --> CA2
    ManageModules --> CNA2
    ManageModules --> CC2
    ManageModules --> AP2
            </div>
        </div>
        
        <h2 id="api-endpoints">7. API Endpoint Structure</h2>
        <div class="diagram-container">
            <div class="diagram-title">REST API Architecture</div>
            <div class="mermaid">
graph LR
    subgraph Auth["Authentication /api/auth"]
        Login[POST /login]
        Register[POST /register]
        GitHub[GET /github]
        Callback[GET /github/callback]
        Supabase[POST /login-supabase]
    end
    
    subgraph Projects["Projects /api/projects"]
        GetProjects[GET /]
        CreateProject[POST /]
        UpdateProject[PUT /:id]
        DeleteProject[DELETE /:id]
        InviteUser[POST /:id/invite]
    end
    
    subgraph Analysis["Analysis /api"]
        URLAnalysis[POST /url-analysis]
        CodeAnalysis[POST /code-analysis]
        ContentAnalysis[POST /content-analysis]
        GetAnalysis[GET /analysis/:id]
    end
    
    subgraph Admin["Admin /api/superadmin"]
        GetUsers[GET /users]
        ApproveUser[POST /users/:id/approve]
        DeactivateUser[POST /users/:id/deactivate]
        GetAllProjects[GET /projects]
    end
    
    subgraph WordPress["WordPress /api/wordpress"]
        Connect[POST /connect]
        GetSites[GET /sites]
        Sync[POST /sync/:id]
        Disconnect[DELETE /disconnect/:id]
    end
            </div>
        </div>
        
        <h2 id="key-features">8. Key System Features</h2>
        
        <h3>Authentication System</h3>
        <div class="feature-box">
            <ul>
                <li><strong>GitHub OAuth</strong>: Custom implementation for GitHub authentication</li>
                <li><strong>Email/Password</strong>: Supabase Auth integration with bcrypt hashing</li>
                <li><strong>Google OAuth</strong>: Supabase Auth (ready for implementation)</li>
                <li><strong>JWT Tokens</strong>: 30-day expiration, stored in localStorage</li>
                <li><strong>Session Management</strong>: Persistent across page reloads</li>
            </ul>
        </div>
        
        <h3>User Management</h3>
        <div class="feature-box">
            <ul>
                <li><strong>Role-Based Access Control (RBAC)</strong>: Superadmin, Admin, User roles</li>
                <li><strong>User Approval System</strong>: New users require approval before activation</li>
                <li><strong>Module Permissions</strong>: Granular access control per module per project</li>
                <li><strong>Activation Logging</strong>: Audit trail for user activation/deactivation</li>
            </ul>
        </div>
        
        <h3>Project Management</h3>
        <div class="feature-box">
            <ul>
                <li><strong>Multi-User Projects</strong>: Admins can invite users to projects</li>
                <li><strong>Project Types</strong>: GitHub, ZIP upload, URL, WordPress</li>
                <li><strong>Module Access</strong>: Control which modules users can access per project</li>
                <li><strong>Project Settings</strong>: Customizable JSONB settings per project</li>
            </ul>
        </div>
        
        <h3>Analysis Modules</h3>
        <div class="feature-box">
            <ol>
                <li><strong>Website Analyst</strong>: URL scanning, SEO, performance, security analysis</li>
                <li><strong>Code Analyst</strong>: Code quality, complexity, technical debt analysis</li>
                <li><strong>Content Analyst</strong>: Content analysis and recommendations</li>
                <li><strong>Content Creator</strong>: AI-powered content generation</li>
                <li><strong>Auto Programmer</strong>: Automated code generation</li>
            </ol>
        </div>
        
        <h3>AI Integration</h3>
        <div class="feature-box">
            <ul>
                <li><strong>Multi-Provider Support</strong>: OpenAI, Google AI, Anthropic</li>
                <li><strong>Response Caching</strong>: 24-hour cache to reduce API costs</li>
                <li><strong>Usage Tracking</strong>: Token usage and cost tracking per user</li>
                <li><strong>Encrypted API Keys</strong>: User-provided API keys stored with AES encryption</li>
            </ul>
        </div>
        
        <h3>WordPress Integration</h3>
        <div class="feature-box">
            <ul>
                <li><strong>Site Connection</strong>: Connect WordPress sites via API key</li>
                <li><strong>Health Monitoring</strong>: Track site health, plugins, themes</li>
                <li><strong>Data Sync</strong>: Synchronize WordPress data for analysis</li>
            </ul>
        </div>
        
        <h2 id="security">9. Security Features</h2>
        <div class="security-box">
            <ul>
                <li><strong>Password Hashing</strong>: bcrypt with salt</li>
                <li><strong>JWT Authentication</strong>: Secure token-based auth</li>
                <li><strong>Row Level Security (RLS)</strong>: PostgreSQL RLS policies</li>
                <li><strong>API Key Encryption</strong>: AES encryption for stored API keys</li>
                <li><strong>SQL Injection Protection</strong>: Parameterized queries</li>
                <li><strong>Rate Limiting</strong>: API rate limiting middleware</li>
                <li><strong>CORS Protection</strong>: Configured CORS policies</li>
            </ul>
        </div>
        
        <h2 id="deployment">10. Deployment Architecture</h2>
        <table>
            <thead>
                <tr>
                    <th>Component</th>
                    <th>Platform</th>
                    <th>Technology</th>
                    <th>Auto-Deploy</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Frontend</td>
                    <td>Vercel</td>
                    <td>React + TypeScript + Vite</td>
                    <td>Yes (main branch)</td>
                </tr>
                <tr>
                    <td>Backend</td>
                    <td>Railway</td>
                    <td>Node.js + Express</td>
                    <td>Yes (main branch)</td>
                </tr>
                <tr>
                    <td>Database</td>
                    <td>Supabase</td>
                    <td>PostgreSQL</td>
                    <td>N/A</td>
                </tr>
            </tbody>
        </table>
        
        <h3>Database Indexes</h3>
        <div class="feature-box">
            <p>Performance-optimized indexes on:</p>
            <ul>
                <li><code>users(is_active, pending_approval)</code></li>
                <li><code>projects(user_id, admin_id, is_active)</code></li>
                <li><code>url_analyses(project_id)</code></li>
                <li><code>code_analyses(project_id)</code></li>
                <li><code>ai_response_cache(input_hash)</code></li>
                <li><code>api_usage_logs(user_id, created_at)</code></li>
                <li><code>wordpress_connections(user_id, api_key)</code></li>
            </ul>
        </div>
        
        <div style="margin-top: 50px; padding-top: 20px; border-top: 2px solid #ecf0f1; text-align: center; color: #666;">
            <p>Generated: <span id="date"></span></p>
            <p>CodeAnalyst System Documentation v1.0</p>
        </div>
    </div>
    
    <script>
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'default',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis'
            },
            sequence: {
                diagramMarginX: 50,
                diagramMarginY: 10,
                actorMargin: 50,
                width: 150,
                height: 65,
                boxMargin: 10,
                boxTextMargin: 5,
                noteMargin: 10,
                messageMargin: 35
            },
            er: {
                fontSize: 12
            }
        });
        
        // Set current date
        document.getElementById('date').textContent = new Date().toLocaleDateString('en-US', { 
            year: 'numeric', 
            month: 'long', 
            day: 'numeric' 
        });
    </script>
</body>
</html>
